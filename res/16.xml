<explain xmlns="http://www.postgresql.org/2009/explain">
  <Query>
    <Plan>
      <Node-Type>Sort</Node-Type>
      <Startup-Cost>47790.61</Startup-Cost>
      <Total-Cost>47798.06</Total-Cost>
      <Plan-Rows>2977</Plan-Rows>
      <Plan-Width>40</Plan-Width>
      <Actual-Startup-Time>3719.759</Actual-Startup-Time>
      <Actual-Total-Time>3724.913</Actual-Total-Time>
      <Actual-Rows>18314</Actual-Rows>
      <Actual-Loops>1</Actual-Loops>
      <Output>
        <Item>part.p_brand</Item>
        <Item>part.p_type</Item>
        <Item>part.p_size</Item>
        <Item>(count(DISTINCT partsupp.ps_suppkey))</Item>
      </Output>
      <Sort-Key>
        <Item>(count(DISTINCT partsupp.ps_suppkey))</Item>
        <Item>part.p_brand</Item>
        <Item>part.p_type</Item>
        <Item>part.p_size</Item>
      </Sort-Key>
      <Sort-Method>quicksort</Sort-Method>
      <Sort-Space-Used>1800</Sort-Space-Used>
      <Sort-Space-Type>Memory</Sort-Space-Type>
      <Plans>
        <Plan>
          <Node-Type>Aggregate</Node-Type>
          <Strategy>Sorted</Strategy>
          <Parent-Relationship>Outer</Parent-Relationship>
          <Startup-Cost>46844.90</Startup-Cost>
          <Total-Cost>47618.85</Total-Cost>
          <Plan-Rows>2977</Plan-Rows>
          <Plan-Width>40</Plan-Width>
          <Actual-Startup-Time>3139.704</Actual-Startup-Time>
          <Actual-Total-Time>3501.036</Actual-Total-Time>
          <Actual-Rows>18314</Actual-Rows>
          <Actual-Loops>1</Actual-Loops>
          <Output>
            <Item>part.p_brand</Item>
            <Item>part.p_type</Item>
            <Item>part.p_size</Item>
            <Item>count(DISTINCT partsupp.ps_suppkey)</Item>
          </Output>
          <Group-Key>
            <Item>part.p_brand</Item>
            <Item>part.p_type</Item>
            <Item>part.p_size</Item>
          </Group-Key>
          <Plans>
            <Plan>
              <Node-Type>Sort</Node-Type>
              <Parent-Relationship>Outer</Parent-Relationship>
              <Startup-Cost>46844.90</Startup-Cost>
              <Total-Cost>46993.74</Total-Cost>
              <Plan-Rows>59534</Plan-Rows>
              <Plan-Width>40</Plan-Width>
              <Actual-Startup-Time>3139.670</Actual-Startup-Time>
              <Actual-Total-Time>3427.279</Actual-Total-Time>
              <Actual-Rows>118274</Actual-Rows>
              <Actual-Loops>1</Actual-Loops>
              <Output>
                <Item>part.p_brand</Item>
                <Item>part.p_type</Item>
                <Item>part.p_size</Item>
                <Item>partsupp.ps_suppkey</Item>
              </Output>
              <Sort-Key>
                <Item>part.p_brand</Item>
                <Item>part.p_type</Item>
                <Item>part.p_size</Item>
              </Sort-Key>
              <Sort-Method>external merge</Sort-Method>
              <Sort-Space-Used>6016</Sort-Space-Used>
              <Sort-Space-Type>Disk</Sort-Space-Type>
              <Plans>
                <Plan>
                  <Node-Type>Hash Join</Node-Type>
                  <Parent-Relationship>Outer</Parent-Relationship>
                  <Join-Type>Inner</Join-Type>
                  <Startup-Cost>9770.09</Startup-Cost>
                  <Total-Cost>42123.43</Total-Cost>
                  <Plan-Rows>59534</Plan-Rows>
                  <Plan-Width>40</Plan-Width>
                  <Actual-Startup-Time>73.143</Actual-Startup-Time>
                  <Actual-Total-Time>831.440</Actual-Total-Time>
                  <Actual-Rows>118274</Actual-Rows>
                  <Actual-Loops>1</Actual-Loops>
                  <Output>
                    <Item>part.p_brand</Item>
                    <Item>part.p_type</Item>
                    <Item>part.p_size</Item>
                    <Item>partsupp.ps_suppkey</Item>
                  </Output>
                  <Hash-Cond>(partsupp.ps_partkey = part.p_partkey)</Hash-Cond>
                  <Plans>
                    <Plan>
                      <Node-Type>Seq Scan</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Relation-Name>partsupp</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>partsupp</Alias>
                      <Startup-Cost>345.00</Startup-Cost>
                      <Total-Cost>27603.00</Total-Cost>
                      <Plan-Rows>400000</Plan-Rows>
                      <Plan-Width>8</Plan-Width>
                      <Actual-Startup-Time>2.627</Actual-Startup-Time>
                      <Actual-Total-Time>393.086</Actual-Total-Time>
                      <Actual-Rows>799680</Actual-Rows>
                      <Actual-Loops>1</Actual-Loops>
                      <Output>
                        <Item>partsupp.ps_partkey</Item>
                        <Item>partsupp.ps_suppkey</Item>
                        <Item>partsupp.ps_availqty</Item>
                        <Item>partsupp.ps_supplycost</Item>
                        <Item>partsupp.ps_comment</Item>
                      </Output>
                      <Filter>(NOT (hashed SubPlan 1))</Filter>
                      <Rows-Removed-by-Filter>320</Rows-Removed-by-Filter>
                      <Plans>
                        <Plan>
                          <Node-Type>Seq Scan</Node-Type>
                          <Parent-Relationship>SubPlan</Parent-Relationship>
                          <Subplan-Name>SubPlan 1</Subplan-Name>
                          <Relation-Name>supplier</Relation-Name>
                          <Schema>public</Schema>
                          <Alias>supplier</Alias>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>345.00</Total-Cost>
                          <Plan-Rows>1</Plan-Rows>
                          <Plan-Width>4</Plan-Width>
                          <Actual-Startup-Time>0.088</Actual-Startup-Time>
                          <Actual-Total-Time>2.391</Actual-Total-Time>
                          <Actual-Rows>4</Actual-Rows>
                          <Actual-Loops>1</Actual-Loops>
                          <Output>
                            <Item>supplier.s_suppkey</Item>
                          </Output>
                          <Filter>((supplier.s_comment)::text ~~ '%Customer%Complaints%'::text)</Filter>
                          <Rows-Removed-by-Filter>9996</Rows-Removed-by-Filter>
                        </Plan>
                      </Plans>
                    </Plan>
                    <Plan>
                      <Node-Type>Hash</Node-Type>
                      <Parent-Relationship>Inner</Parent-Relationship>
                      <Startup-Cost>9053.00</Startup-Cost>
                      <Total-Cost>9053.00</Total-Cost>
                      <Plan-Rows>29767</Plan-Rows>
                      <Plan-Width>40</Plan-Width>
                      <Actual-Startup-Time>70.493</Actual-Startup-Time>
                      <Actual-Total-Time>70.493</Actual-Total-Time>
                      <Actual-Rows>29581</Actual-Rows>
                      <Actual-Loops>1</Actual-Loops>
                      <Output>
                        <Item>part.p_brand</Item>
                        <Item>part.p_type</Item>
                        <Item>part.p_size</Item>
                        <Item>part.p_partkey</Item>
                      </Output>
                      <Hash-Buckets>4096</Hash-Buckets>
                      <Hash-Batches>1</Hash-Batches>
                      <Original-Hash-Batches>1</Original-Hash-Batches>
                      <Peak-Memory-Usage>1793</Peak-Memory-Usage>
                      <Plans>
                        <Plan>
                          <Node-Type>Seq Scan</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Relation-Name>part</Relation-Name>
                          <Schema>public</Schema>
                          <Alias>part</Alias>
                          <Startup-Cost>0.00</Startup-Cost>
                          <Total-Cost>9053.00</Total-Cost>
                          <Plan-Rows>29767</Plan-Rows>
                          <Plan-Width>40</Plan-Width>
                          <Actual-Startup-Time>0.009</Actual-Startup-Time>
                          <Actual-Total-Time>55.271</Actual-Total-Time>
                          <Actual-Rows>29581</Actual-Rows>
                          <Actual-Loops>1</Actual-Loops>
                          <Output>
                            <Item>part.p_brand</Item>
                            <Item>part.p_type</Item>
                            <Item>part.p_size</Item>
                            <Item>part.p_partkey</Item>
                          </Output>
                          <Filter>((part.p_brand &lt;&gt; 'Brand#45'::bpchar) AND ((part.p_type)::text !~~ 'MEDIUM POLISHED%%'::text) AND (part.p_size = ANY ('{49,14,23,45,19,3,36,9}'::integer[])))</Filter>
                          <Rows-Removed-by-Filter>170419</Rows-Removed-by-Filter>
                        </Plan>
                      </Plans>
                    </Plan>
                  </Plans>
                </Plan>
              </Plans>
            </Plan>
          </Plans>
        </Plan>
      </Plans>
    </Plan>
    <Planning-Time>3.106</Planning-Time>
    <Triggers>
    </Triggers>
    <Execution-Time>3731.627</Execution-Time>
  </Query>
</explain>