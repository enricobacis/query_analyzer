<explain xmlns="http://www.postgresql.org/2009/explain">
  <Query>
    <Plan>
      <Node-Type>Limit</Node-Type>
      <Startup-Cost>1206286.36</Startup-Cost>
      <Total-Cost>1206289.36</Total-Cost>
      <Plan-Rows>100</Plan-Rows>
      <Plan-Width>44</Plan-Width>
      <Actual-Startup-Time>12195.472</Actual-Startup-Time>
      <Actual-Total-Time>12195.841</Actual-Total-Time>
      <Actual-Rows>57</Actual-Rows>
      <Actual-Loops>1</Actual-Loops>
      <Output>
        <Item>customer.c_name</Item>
        <Item>customer.c_custkey</Item>
        <Item>orders.o_orderkey</Item>
        <Item>orders.o_orderdate</Item>
        <Item>orders.o_totalprice</Item>
        <Item>(sum(lineitem.l_quantity))</Item>
      </Output>
      <Plans>
        <Plan>
          <Node-Type>Aggregate</Node-Type>
          <Strategy>Sorted</Strategy>
          <Parent-Relationship>Outer</Parent-Relationship>
          <Startup-Cost>1206286.36</Startup-Cost>
          <Total-Cost>1296304.60</Total-Cost>
          <Plan-Rows>3000608</Plan-Rows>
          <Plan-Width>44</Plan-Width>
          <Actual-Startup-Time>12195.470</Actual-Startup-Time>
          <Actual-Total-Time>12195.816</Actual-Total-Time>
          <Actual-Rows>57</Actual-Rows>
          <Actual-Loops>1</Actual-Loops>
          <Output>
            <Item>customer.c_name</Item>
            <Item>customer.c_custkey</Item>
            <Item>orders.o_orderkey</Item>
            <Item>orders.o_orderdate</Item>
            <Item>orders.o_totalprice</Item>
            <Item>sum(lineitem.l_quantity)</Item>
          </Output>
          <Group-Key>
            <Item>orders.o_totalprice</Item>
            <Item>orders.o_orderdate</Item>
            <Item>customer.c_name</Item>
            <Item>customer.c_custkey</Item>
            <Item>orders.o_orderkey</Item>
          </Group-Key>
          <Plans>
            <Plan>
              <Node-Type>Sort</Node-Type>
              <Parent-Relationship>Outer</Parent-Relationship>
              <Startup-Cost>1206286.36</Startup-Cost>
              <Total-Cost>1213787.88</Total-Cost>
              <Plan-Rows>3000608</Plan-Rows>
              <Plan-Width>44</Plan-Width>
              <Actual-Startup-Time>12195.448</Actual-Startup-Time>
              <Actual-Total-Time>12195.555</Actual-Total-Time>
              <Actual-Rows>399</Actual-Rows>
              <Actual-Loops>1</Actual-Loops>
              <Output>
                <Item>customer.c_name</Item>
                <Item>customer.c_custkey</Item>
                <Item>orders.o_orderkey</Item>
                <Item>orders.o_orderdate</Item>
                <Item>orders.o_totalprice</Item>
                <Item>lineitem.l_quantity</Item>
              </Output>
              <Sort-Key>
                <Item>orders.o_totalprice</Item>
                <Item>orders.o_orderdate</Item>
                <Item>customer.c_name</Item>
                <Item>customer.c_custkey</Item>
                <Item>orders.o_orderkey</Item>
              </Sort-Key>
              <Sort-Method>quicksort</Sort-Method>
              <Sort-Space-Used>45</Sort-Space-Used>
              <Sort-Space-Type>Memory</Sort-Space-Type>
              <Plans>
                <Plan>
                  <Node-Type>Hash Join</Node-Type>
                  <Parent-Relationship>Outer</Parent-Relationship>
                  <Join-Type>Inner</Join-Type>
                  <Startup-Cost>411602.78</Startup-Cost>
                  <Total-Cost>709112.60</Total-Cost>
                  <Plan-Rows>3000608</Plan-Rows>
                  <Plan-Width>44</Plan-Width>
                  <Actual-Startup-Time>7532.930</Actual-Startup-Time>
                  <Actual-Total-Time>12194.130</Actual-Total-Time>
                  <Actual-Rows>399</Actual-Rows>
                  <Actual-Loops>1</Actual-Loops>
                  <Output>
                    <Item>customer.c_name</Item>
                    <Item>customer.c_custkey</Item>
                    <Item>orders.o_orderkey</Item>
                    <Item>orders.o_orderdate</Item>
                    <Item>orders.o_totalprice</Item>
                    <Item>lineitem.l_quantity</Item>
                  </Output>
                  <Hash-Cond>(lineitem.l_orderkey = orders.o_orderkey)</Hash-Cond>
                  <Plans>
                    <Plan>
                      <Node-Type>Seq Scan</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Relation-Name>lineitem</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>lineitem</Alias>
                      <Startup-Cost>0.00</Startup-Cost>
                      <Total-Cost>171024.15</Total-Cost>
                      <Plan-Rows>6001215</Plan-Rows>
                      <Plan-Width>9</Plan-Width>
                      <Actual-Startup-Time>0.003</Actual-Startup-Time>
                      <Actual-Total-Time>2452.620</Actual-Total-Time>
                      <Actual-Rows>6001215</Actual-Rows>
                      <Actual-Loops>1</Actual-Loops>
                      <Output>
                        <Item>lineitem.l_quantity</Item>
                        <Item>lineitem.l_orderkey</Item>
                      </Output>
                    </Plan>
                    <Plan>
                      <Node-Type>Hash</Node-Type>
                      <Parent-Relationship>Inner</Parent-Relationship>
                      <Startup-Cost>396001.78</Startup-Cost>
                      <Total-Cost>396001.78</Total-Cost>
                      <Plan-Rows>750000</Plan-Rows>
                      <Plan-Width>43</Plan-Width>
                      <Actual-Startup-Time>6950.719</Actual-Startup-Time>
                      <Actual-Total-Time>6950.719</Actual-Total-Time>
                      <Actual-Rows>57</Actual-Rows>
                      <Actual-Loops>1</Actual-Loops>
                      <Output>
                        <Item>customer.c_name</Item>
                        <Item>customer.c_custkey</Item>
                        <Item>orders.o_orderkey</Item>
                        <Item>orders.o_orderdate</Item>
                        <Item>orders.o_totalprice</Item>
                        <Item>lineitem_1.l_orderkey</Item>
                      </Output>
                      <Hash-Buckets>8192</Hash-Buckets>
                      <Hash-Batches>16</Hash-Batches>
                      <Original-Hash-Batches>16</Original-Hash-Batches>
                      <Peak-Memory-Usage>1</Peak-Memory-Usage>
                      <Plans>
                        <Plan>
                          <Node-Type>Hash Join</Node-Type>
                          <Parent-Relationship>Outer</Parent-Relationship>
                          <Join-Type>Inner</Join-Type>
                          <Startup-Cost>7802.86</Startup-Cost>
                          <Total-Cost>396001.78</Total-Cost>
                          <Plan-Rows>750000</Plan-Rows>
                          <Plan-Width>43</Plan-Width>
                          <Actual-Startup-Time>156.459</Actual-Startup-Time>
                          <Actual-Total-Time>6950.033</Actual-Total-Time>
                          <Actual-Rows>57</Actual-Rows>
                          <Actual-Loops>1</Actual-Loops>
                          <Output>
                            <Item>customer.c_name</Item>
                            <Item>customer.c_custkey</Item>
                            <Item>orders.o_orderkey</Item>
                            <Item>orders.o_orderdate</Item>
                            <Item>orders.o_totalprice</Item>
                            <Item>lineitem_1.l_orderkey</Item>
                          </Output>
                          <Hash-Cond>(orders.o_custkey = customer.c_custkey)</Hash-Cond>
                          <Plans>
                            <Plan>
                              <Node-Type>Merge Join</Node-Type>
                              <Parent-Relationship>Outer</Parent-Relationship>
                              <Join-Type>Semi</Join-Type>
                              <Startup-Cost>0.86</Startup-Cost>
                              <Total-Cost>364468.28</Total-Cost>
                              <Plan-Rows>750000</Plan-Rows>
                              <Plan-Width>24</Plan-Width>
                              <Actual-Startup-Time>9.956</Actual-Startup-Time>
                              <Actual-Total-Time>6814.944</Actual-Total-Time>
                              <Actual-Rows>57</Actual-Rows>
                              <Actual-Loops>1</Actual-Loops>
                              <Output>
                                <Item>orders.o_orderkey</Item>
                                <Item>orders.o_orderdate</Item>
                                <Item>orders.o_totalprice</Item>
                                <Item>orders.o_custkey</Item>
                                <Item>lineitem_1.l_orderkey</Item>
                              </Output>
                              <Merge-Cond>(orders.o_orderkey = lineitem_1.l_orderkey)</Merge-Cond>
                              <Plans>
                                <Plan>
                                  <Node-Type>Index Scan</Node-Type>
                                  <Parent-Relationship>Outer</Parent-Relationship>
                                  <Scan-Direction>Forward</Scan-Direction>
                                  <Index-Name>o_orderkey_idx</Index-Name>
                                  <Relation-Name>orders</Relation-Name>
                                  <Schema>public</Schema>
                                  <Alias>orders</Alias>
                                  <Startup-Cost>0.43</Startup-Cost>
                                  <Total-Cost>61396.43</Total-Cost>
                                  <Plan-Rows>1500000</Plan-Rows>
                                  <Plan-Width>20</Plan-Width>
                                  <Actual-Startup-Time>0.005</Actual-Startup-Time>
                                  <Actual-Total-Time>906.735</Actual-Total-Time>
                                  <Actual-Rows>1496151</Actual-Rows>
                                  <Actual-Loops>1</Actual-Loops>
                                  <Output>
                                    <Item>orders.o_orderkey</Item>
                                    <Item>orders.o_custkey</Item>
                                    <Item>orders.o_orderstatus</Item>
                                    <Item>orders.o_totalprice</Item>
                                    <Item>orders.o_orderdate</Item>
                                    <Item>orders.o_orderpriority</Item>
                                    <Item>orders.o_clerk</Item>
                                    <Item>orders.o_shippriority</Item>
                                    <Item>orders.o_comment</Item>
                                  </Output>
                                </Plan>
                                <Plan>
                                  <Node-Type>Materialize</Node-Type>
                                  <Parent-Relationship>Inner</Parent-Relationship>
                                  <Startup-Cost>0.43</Startup-Cost>
                                  <Total-Cost>294447.53</Total-Cost>
                                  <Plan-Rows>389946</Plan-Rows>
                                  <Plan-Width>4</Plan-Width>
                                  <Actual-Startup-Time>7.623</Actual-Startup-Time>
                                  <Actual-Total-Time>5448.741</Actual-Total-Time>
                                  <Actual-Rows>57</Actual-Rows>
                                  <Actual-Loops>1</Actual-Loops>
                                  <Output>
                                    <Item>lineitem_1.l_orderkey</Item>
                                  </Output>
                                  <Plans>
                                    <Plan>
                                      <Node-Type>Aggregate</Node-Type>
                                      <Strategy>Sorted</Strategy>
                                      <Parent-Relationship>Outer</Parent-Relationship>
                                      <Startup-Cost>0.43</Startup-Cost>
                                      <Total-Cost>289573.20</Total-Cost>
                                      <Plan-Rows>389946</Plan-Rows>
                                      <Plan-Width>9</Plan-Width>
                                      <Actual-Startup-Time>7.620</Actual-Startup-Time>
                                      <Actual-Total-Time>5448.603</Actual-Total-Time>
                                      <Actual-Rows>57</Actual-Rows>
                                      <Actual-Loops>1</Actual-Loops>
                                      <Output>
                                        <Item>lineitem_1.l_orderkey</Item>
                                      </Output>
                                      <Group-Key>
                                        <Item>lineitem_1.l_orderkey</Item>
                                      </Group-Key>
                                      <Filter>(sum(lineitem_1.l_quantity) &gt; 300::numeric)</Filter>
                                      <Rows-Removed-by-Filter>1499943</Rows-Removed-by-Filter>
                                      <Plans>
                                        <Plan>
                                          <Node-Type>Index Scan</Node-Type>
                                          <Parent-Relationship>Outer</Parent-Relationship>
                                          <Scan-Direction>Forward</Scan-Direction>
                                          <Index-Name>l_orderkey_idx</Index-Name>
                                          <Relation-Name>lineitem</Relation-Name>
                                          <Schema>public</Schema>
                                          <Alias>lineitem_1</Alias>
                                          <Startup-Cost>0.43</Startup-Cost>
                                          <Total-Cost>253717.94</Total-Cost>
                                          <Plan-Rows>6001215</Plan-Rows>
                                          <Plan-Width>9</Plan-Width>
                                          <Actual-Startup-Time>0.005</Actual-Startup-Time>
                                          <Actual-Total-Time>2705.916</Actual-Total-Time>
                                          <Actual-Rows>6001215</Actual-Rows>
                                          <Actual-Loops>1</Actual-Loops>
                                          <Output>
                                            <Item>lineitem_1.l_orderkey</Item>
                                            <Item>lineitem_1.l_partkey</Item>
                                            <Item>lineitem_1.l_suppkey</Item>
                                            <Item>lineitem_1.l_linenumber</Item>
                                            <Item>lineitem_1.l_quantity</Item>
                                            <Item>lineitem_1.l_extendedprice</Item>
                                            <Item>lineitem_1.l_discount</Item>
                                            <Item>lineitem_1.l_tax</Item>
                                            <Item>lineitem_1.l_returnflag</Item>
                                            <Item>lineitem_1.l_linestatus</Item>
                                            <Item>lineitem_1.l_shipdate</Item>
                                            <Item>lineitem_1.l_commitdate</Item>
                                            <Item>lineitem_1.l_receiptdate</Item>
                                            <Item>lineitem_1.l_shipinstruct</Item>
                                            <Item>lineitem_1.l_shipmode</Item>
                                            <Item>lineitem_1.l_comment</Item>
                                          </Output>
                                        </Plan>
                                      </Plans>
                                    </Plan>
                                  </Plans>
                                </Plan>
                              </Plans>
                            </Plan>
                            <Plan>
                              <Node-Type>Hash</Node-Type>
                              <Parent-Relationship>Inner</Parent-Relationship>
                              <Startup-Cost>5048.00</Startup-Cost>
                              <Total-Cost>5048.00</Total-Cost>
                              <Plan-Rows>150000</Plan-Rows>
                              <Plan-Width>23</Plan-Width>
                              <Actual-Startup-Time>120.076</Actual-Startup-Time>
                              <Actual-Total-Time>120.076</Actual-Total-Time>
                              <Actual-Rows>150000</Actual-Rows>
                              <Actual-Loops>1</Actual-Loops>
                              <Output>
                                <Item>customer.c_name</Item>
                                <Item>customer.c_custkey</Item>
                              </Output>
                              <Hash-Buckets>16384</Hash-Buckets>
                              <Hash-Batches>2</Hash-Batches>
                              <Original-Hash-Batches>2</Original-Hash-Batches>
                              <Peak-Memory-Usage>3234</Peak-Memory-Usage>
                              <Plans>
                                <Plan>
                                  <Node-Type>Seq Scan</Node-Type>
                                  <Parent-Relationship>Outer</Parent-Relationship>
                                  <Relation-Name>customer</Relation-Name>
                                  <Schema>public</Schema>
                                  <Alias>customer</Alias>
                                  <Startup-Cost>0.00</Startup-Cost>
                                  <Total-Cost>5048.00</Total-Cost>
                                  <Plan-Rows>150000</Plan-Rows>
                                  <Plan-Width>23</Plan-Width>
                                  <Actual-Startup-Time>0.003</Actual-Startup-Time>
                                  <Actual-Total-Time>53.590</Actual-Total-Time>
                                  <Actual-Rows>150000</Actual-Rows>
                                  <Actual-Loops>1</Actual-Loops>
                                  <Output>
                                    <Item>customer.c_name</Item>
                                    <Item>customer.c_custkey</Item>
                                  </Output>
                                </Plan>
                              </Plans>
                            </Plan>
                          </Plans>
                        </Plan>
                      </Plans>
                    </Plan>
                  </Plans>
                </Plan>
              </Plans>
            </Plan>
          </Plans>
        </Plan>
      </Plans>
    </Plan>
    <Planning-Time>3.756</Planning-Time>
    <Triggers>
    </Triggers>
    <Execution-Time>12196.602</Execution-Time>
  </Query>
</explain>