<explain xmlns="http://www.postgresql.org/2009/explain">
  <Query>
    <Plan>
      <Node-Type>Aggregate</Node-Type>
      <Strategy>Plain</Strategy>
      <Startup-Cost>215604.42</Startup-Cost>
      <Total-Cost>215604.44</Total-Cost>
      <Plan-Rows>1</Plan-Rows>
      <Plan-Width>33</Plan-Width>
      <Actual-Startup-Time>3466.605</Actual-Startup-Time>
      <Actual-Total-Time>3466.606</Actual-Total-Time>
      <Actual-Rows>1</Actual-Rows>
      <Actual-Loops>1</Actual-Loops>
      <Output>
        <Item>((100.00 * sum(CASE WHEN ((part.p_type)::text ~~ 'PROMO%'::text) THEN (lineitem.l_extendedprice * (1::numeric - lineitem.l_discount)) ELSE 0::numeric END)) / sum((lineitem.l_extendedprice * (1::numeric - lineitem.l_discount))))</Item>
      </Output>
      <Plans>
        <Plan>
          <Node-Type>Hash Join</Node-Type>
          <Parent-Relationship>Outer</Parent-Relationship>
          <Join-Type>Inner</Join-Type>
          <Startup-Cost>9823.00</Startup-Cost>
          <Total-Cost>214204.84</Total-Cost>
          <Plan-Rows>79976</Plan-Rows>
          <Plan-Width>33</Plan-Width>
          <Actual-Startup-Time>194.562</Actual-Startup-Time>
          <Actual-Total-Time>3392.038</Actual-Total-Time>
          <Actual-Rows>75983</Actual-Rows>
          <Actual-Loops>1</Actual-Loops>
          <Output>
            <Item>lineitem.l_extendedprice</Item>
            <Item>lineitem.l_discount</Item>
            <Item>part.p_type</Item>
          </Output>
          <Hash-Cond>(lineitem.l_partkey = part.p_partkey)</Hash-Cond>
          <Plans>
            <Plan>
              <Node-Type>Seq Scan</Node-Type>
              <Parent-Relationship>Outer</Parent-Relationship>
              <Relation-Name>lineitem</Relation-Name>
              <Schema>public</Schema>
              <Alias>lineitem</Alias>
              <Startup-Cost>0.00</Startup-Cost>
              <Total-Cost>201030.23</Total-Cost>
              <Plan-Rows>79976</Plan-Rows>
              <Plan-Width>16</Plan-Width>
              <Actual-Startup-Time>0.302</Actual-Startup-Time>
              <Actual-Total-Time>3045.935</Actual-Total-Time>
              <Actual-Rows>75983</Actual-Rows>
              <Actual-Loops>1</Actual-Loops>
              <Output>
                <Item>lineitem.l_extendedprice</Item>
                <Item>lineitem.l_discount</Item>
                <Item>lineitem.l_partkey</Item>
              </Output>
              <Filter>((lineitem.l_shipdate &gt;= '1995-09-01'::date) AND (lineitem.l_shipdate &lt; '1995-10-01 00:00:00'::timestamp without time zone))</Filter>
              <Rows-Removed-by-Filter>5925232</Rows-Removed-by-Filter>
            </Plan>
            <Plan>
              <Node-Type>Hash</Node-Type>
              <Parent-Relationship>Inner</Parent-Relationship>
              <Startup-Cost>6053.00</Startup-Cost>
              <Total-Cost>6053.00</Total-Cost>
              <Plan-Rows>200000</Plan-Rows>
              <Plan-Width>25</Plan-Width>
              <Actual-Startup-Time>193.672</Actual-Startup-Time>
              <Actual-Total-Time>193.672</Actual-Total-Time>
              <Actual-Rows>200000</Actual-Rows>
              <Actual-Loops>1</Actual-Loops>
              <Output>
                <Item>part.p_type</Item>
                <Item>part.p_partkey</Item>
              </Output>
              <Hash-Buckets>16384</Hash-Buckets>
              <Hash-Batches>4</Hash-Batches>
              <Original-Hash-Batches>4</Original-Hash-Batches>
              <Peak-Memory-Usage>2319</Peak-Memory-Usage>
              <Plans>
                <Plan>
                  <Node-Type>Seq Scan</Node-Type>
                  <Parent-Relationship>Outer</Parent-Relationship>
                  <Relation-Name>part</Relation-Name>
                  <Schema>public</Schema>
                  <Alias>part</Alias>
                  <Startup-Cost>0.00</Startup-Cost>
                  <Total-Cost>6053.00</Total-Cost>
                  <Plan-Rows>200000</Plan-Rows>
                  <Plan-Width>25</Plan-Width>
                  <Actual-Startup-Time>0.001</Actual-Startup-Time>
                  <Actual-Total-Time>102.519</Actual-Total-Time>
                  <Actual-Rows>200000</Actual-Rows>
                  <Actual-Loops>1</Actual-Loops>
                  <Output>
                    <Item>part.p_type</Item>
                    <Item>part.p_partkey</Item>
                  </Output>
                </Plan>
              </Plans>
            </Plan>
          </Plans>
        </Plan>
      </Plans>
    </Plan>
    <Planning-Time>4.112</Planning-Time>
    <Triggers>
    </Triggers>
    <Execution-Time>3467.123</Execution-Time>
  </Query>
</explain>