<explain xmlns="http://www.postgresql.org/2009/explain">
  <Query>
    <Plan>
      <Node-Type>Sort</Node-Type>
      <Startup-Cost>314250.03</Startup-Cost>
      <Total-Cost>314250.04</Total-Cost>
      <Plan-Rows>1</Plan-Rows>
      <Plan-Width>27</Plan-Width>
      <Actual-Startup-Time>4871.178</Actual-Startup-Time>
      <Actual-Total-Time>4871.187</Actual-Total-Time>
      <Actual-Rows>2</Actual-Rows>
      <Actual-Loops>1</Actual-Loops>
      <Output>
        <Item>lineitem.l_shipmode</Item>
        <Item>(sum(CASE WHEN ((orders.o_orderpriority = '1-URGENT'::bpchar) OR (orders.o_orderpriority = '2-HIGH'::bpchar)) THEN 1 ELSE 0 END))</Item>
        <Item>(sum(CASE WHEN ((orders.o_orderpriority &lt;&gt; '1-URGENT'::bpchar) AND (orders.o_orderpriority &lt;&gt; '2-HIGH'::bpchar)) THEN 1 ELSE 0 END))</Item>
      </Output>
      <Sort-Key>
        <Item>lineitem.l_shipmode</Item>
      </Sort-Key>
      <Sort-Method>quicksort</Sort-Method>
      <Sort-Space-Used>17</Sort-Space-Used>
      <Sort-Space-Type>Memory</Sort-Space-Type>
      <Plans>
        <Plan>
          <Node-Type>Aggregate</Node-Type>
          <Strategy>Hashed</Strategy>
          <Parent-Relationship>Outer</Parent-Relationship>
          <Startup-Cost>314250.01</Startup-Cost>
          <Total-Cost>314250.02</Total-Cost>
          <Plan-Rows>1</Plan-Rows>
          <Plan-Width>27</Plan-Width>
          <Actual-Startup-Time>4870.561</Actual-Startup-Time>
          <Actual-Total-Time>4870.561</Actual-Total-Time>
          <Actual-Rows>2</Actual-Rows>
          <Actual-Loops>1</Actual-Loops>
          <Output>
            <Item>lineitem.l_shipmode</Item>
            <Item>sum(CASE WHEN ((orders.o_orderpriority = '1-URGENT'::bpchar) OR (orders.o_orderpriority = '2-HIGH'::bpchar)) THEN 1 ELSE 0 END)</Item>
            <Item>sum(CASE WHEN ((orders.o_orderpriority &lt;&gt; '1-URGENT'::bpchar) AND (orders.o_orderpriority &lt;&gt; '2-HIGH'::bpchar)) THEN 1 ELSE 0 END)</Item>
          </Output>
          <Group-Key>
            <Item>lineitem.l_shipmode</Item>
          </Group-Key>
          <Plans>
            <Plan>
              <Node-Type>Merge Join</Node-Type>
              <Parent-Relationship>Outer</Parent-Relationship>
              <Join-Type>Inner</Join-Type>
              <Startup-Cost>248175.90</Startup-Cost>
              <Total-Cost>313745.38</Total-Cost>
              <Plan-Rows>28836</Plan-Rows>
              <Plan-Width>27</Plan-Width>
              <Actual-Startup-Time>3513.447</Actual-Startup-Time>
              <Actual-Total-Time>4845.732</Actual-Total-Time>
              <Actual-Rows>30988</Actual-Rows>
              <Actual-Loops>1</Actual-Loops>
              <Output>
                <Item>orders.o_orderpriority</Item>
                <Item>lineitem.l_shipmode</Item>
              </Output>
              <Merge-Cond>(orders.o_orderkey = lineitem.l_orderkey)</Merge-Cond>
              <Plans>
                <Plan>
                  <Node-Type>Index Scan</Node-Type>
                  <Parent-Relationship>Outer</Parent-Relationship>
                  <Scan-Direction>Forward</Scan-Direction>
                  <Index-Name>o_orderkey_idx</Index-Name>
                  <Relation-Name>orders</Relation-Name>
                  <Schema>public</Schema>
                  <Alias>orders</Alias>
                  <Startup-Cost>0.43</Startup-Cost>
                  <Total-Cost>61396.43</Total-Cost>
                  <Plan-Rows>1500000</Plan-Rows>
                  <Plan-Width>20</Plan-Width>
                  <Actual-Startup-Time>0.008</Actual-Startup-Time>
                  <Actual-Total-Time>846.528</Actual-Total-Time>
                  <Actual-Rows>1499957</Actual-Rows>
                  <Actual-Loops>1</Actual-Loops>
                  <Output>
                    <Item>orders.o_orderkey</Item>
                    <Item>orders.o_custkey</Item>
                    <Item>orders.o_orderstatus</Item>
                    <Item>orders.o_totalprice</Item>
                    <Item>orders.o_orderdate</Item>
                    <Item>orders.o_orderpriority</Item>
                    <Item>orders.o_clerk</Item>
                    <Item>orders.o_shippriority</Item>
                    <Item>orders.o_comment</Item>
                  </Output>
                </Plan>
                <Plan>
                  <Node-Type>Sort</Node-Type>
                  <Parent-Relationship>Inner</Parent-Relationship>
                  <Startup-Cost>248175.45</Startup-Cost>
                  <Total-Cost>248247.54</Total-Cost>
                  <Plan-Rows>28836</Plan-Rows>
                  <Plan-Width>15</Plan-Width>
                  <Actual-Startup-Time>3513.161</Actual-Startup-Time>
                  <Actual-Total-Time>3522.238</Actual-Total-Time>
                  <Actual-Rows>30988</Actual-Rows>
                  <Actual-Loops>1</Actual-Loops>
                  <Output>
                    <Item>lineitem.l_shipmode</Item>
                    <Item>lineitem.l_orderkey</Item>
                  </Output>
                  <Sort-Key>
                    <Item>lineitem.l_orderkey</Item>
                  </Sort-Key>
                  <Sort-Method>quicksort</Sort-Method>
                  <Sort-Space-Used>1723</Sort-Space-Used>
                  <Sort-Space-Type>Memory</Sort-Space-Type>
                  <Plans>
                    <Plan>
                      <Node-Type>Seq Scan</Node-Type>
                      <Parent-Relationship>Outer</Parent-Relationship>
                      <Relation-Name>lineitem</Relation-Name>
                      <Schema>public</Schema>
                      <Alias>lineitem</Alias>
                      <Startup-Cost>0.00</Startup-Cost>
                      <Total-Cost>246039.34</Total-Cost>
                      <Plan-Rows>28836</Plan-Rows>
                      <Plan-Width>15</Plan-Width>
                      <Actual-Startup-Time>0.463</Actual-Startup-Time>
                      <Actual-Total-Time>3487.887</Actual-Total-Time>
                      <Actual-Rows>30988</Actual-Rows>
                      <Actual-Loops>1</Actual-Loops>
                      <Output>
                        <Item>lineitem.l_shipmode</Item>
                        <Item>lineitem.l_orderkey</Item>
                      </Output>
                      <Filter>((lineitem.l_shipmode = ANY ('{MAIL,SHIP}'::bpchar[])) AND (lineitem.l_commitdate &lt; lineitem.l_receiptdate) AND (lineitem.l_shipdate &lt; lineitem.l_commitdate) AND (lineitem.l_receiptdate &gt;= '1994-01-01'::date) AND (lineitem.l_receiptdate &lt; '1995-01-01 00:00:00'::timestamp without time zone))</Filter>
                      <Rows-Removed-by-Filter>5970227</Rows-Removed-by-Filter>
                    </Plan>
                  </Plans>
                </Plan>
              </Plans>
            </Plan>
          </Plans>
        </Plan>
      </Plans>
    </Plan>
    <Planning-Time>0.784</Planning-Time>
    <Triggers>
    </Triggers>
    <Execution-Time>4871.841</Execution-Time>
  </Query>
</explain>